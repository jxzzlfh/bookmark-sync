# æ˜Ÿç—•å¯¼èˆª (Bookmark Sync)

æµè§ˆå™¨ä¹¦ç­¾äº‘ç«¯åŒæ­¥ç³»ç»Ÿ - å°†æœ¬åœ°ä¹¦ç­¾åŒæ­¥åˆ°äº‘ç«¯ï¼Œä»¥ç²¾ç¾çš„å¯¼èˆªç½‘ç«™å½¢å¼å±•ç¤ºã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- **å•å‘åŒæ­¥** - æµè§ˆå™¨ä¹¦ç­¾ â†’ äº‘ç«¯ï¼Œæµè§ˆå™¨ä¸ºå”¯ä¸€æ•°æ®æº
- **å®æ—¶ç›‘å¬** - æœ¬åœ°ä¹¦ç­¾å¢åˆ æ”¹ç§»åŠ¨ï¼Œè‡ªåŠ¨åŒæ­¥åˆ°æœåŠ¡å™¨
- **å®šæ—¶åŒæ­¥** - æ¯ 5 åˆ†é’Ÿè‡ªåŠ¨å…¨é‡åŒæ­¥ + æ‰‹åŠ¨åŒæ­¥
- **ç²¾ç¾å¯¼èˆª** - å¯¼èˆªç½‘ç«™æŒ‰ç›®å½•ç»“æ„å±•ç¤ºä¹¦ç­¾ï¼Œæ”¯æŒäº®è‰²/æš—è‰²/è‡ªåŠ¨ä¸»é¢˜
- **å…¨å±€æœç´¢** - å¿«æ·é”® `Ctrl+0` å¿«é€Ÿæœç´¢æ‰€æœ‰ä¹¦ç­¾
- **è‡ªæ‰˜ç®¡** - æ•°æ®å®Œå…¨è‡ªä¸»æŒæ§ï¼Œæ”¯æŒ Docker ä¸€é”®éƒ¨ç½²

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              æ˜Ÿç—•å¯¼èˆª ç³»ç»Ÿæ¶æ„                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Chrome æµè§ˆå™¨    â”‚                      â”‚   å¯¼èˆªç½‘ç«™ (Web)   â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚  ä¹¦ç­¾ç®¡ç†å™¨  â”‚  â”‚                      â”‚  â”‚  ä¹¦ç­¾å±•ç¤º   â”‚  â”‚
    â”‚  â”‚  (æœ¬åœ°ä¹¦ç­¾)  â”‚  â”‚                      â”‚  â”‚  å…¨å±€æœç´¢   â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚                      â”‚  â”‚  ä¸»é¢˜åˆ‡æ¢   â”‚  â”‚
    â”‚         â”‚         â”‚                      â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”‚                      â”‚         â”‚         â”‚
    â”‚  â”‚ æµè§ˆå™¨æ‰©å±•   â”‚  â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚  â”‚ (Manifest V3)â”‚  â”‚                                â”‚
    â”‚  â”‚             â”‚  â”‚    HTTPS REST API              â”‚
    â”‚  â”‚ â€¢ ä¹¦ç­¾ç›‘å¬  â”‚  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  â”‚ â€¢ å…¨é‡åŒæ­¥  â”‚  â”‚                      â”‚    åŒæ­¥æœåŠ¡å™¨      â”‚
    â”‚  â”‚ â€¢ å®æ—¶æ¨é€  â”‚  â”‚                      â”‚   (Node.js)       â”‚
    â”‚  â”‚ â€¢ å®šæ—¶ä»»åŠ¡  â”‚  â”‚                      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                      â”‚  â”‚ Express API â”‚  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚  â”‚  â€¢ è®¤è¯     â”‚  â”‚
                                               â”‚  â”‚  â€¢ CRUD     â”‚  â”‚
           â–²                                   â”‚  â”‚  â€¢ æœç´¢     â”‚  â”‚
           â”‚ chrome.bookmarks API              â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚
           â”‚                                   â”‚         â”‚         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  ä¹¦ç­¾äº‹ä»¶    â”‚                            â”‚  â”‚   SQLite    â”‚  â”‚
    â”‚ â€¢ onCreated â”‚                            â”‚  â”‚  (sql.js)   â”‚  â”‚
    â”‚ â€¢ onChanged â”‚                            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚ â€¢ onRemoved â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ â€¢ onMoved   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åŒæ­¥æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           åŒæ­¥æµç¨‹ç¤ºæ„å›¾                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  æµè§ˆå™¨æ‰©å±•                                              æœåŠ¡å™¨
      â”‚                                                    â”‚
      â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 1. ç”¨æˆ·ç‚¹å‡»"ç«‹å³åŒæ­¥" â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º    â”‚
      â”‚                                                    â”‚
      â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 2. POST /api/bookmarks/clear â”€â”€â”€â”€â”€â”€ â”‚
      â”‚                    (æ¸…ç©ºæœåŠ¡å™¨æ•°æ®)                  â”‚
      â”‚                                                    â”‚
      â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 3. è·å–æœ¬åœ°ä¹¦ç­¾æ ‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º         â”‚
      â”‚              chrome.bookmarks.getTree()            â”‚
      â”‚                                                    â”‚
      â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 4. æŒ‰æ·±åº¦æ’åºï¼Œçˆ¶èŠ‚ç‚¹ä¼˜å…ˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚
      â”‚                                                    â”‚
      â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 5. é€ä¸ªä¸Šä¼ ä¹¦ç­¾/æ–‡ä»¶å¤¹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º    â”‚
      â”‚              POST /api/bookmarks                   â”‚
      â”‚              (å»ºç«‹ localId â†” remoteId æ˜ å°„)         â”‚
      â”‚                                                    â”‚
      â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 6. è¿”å›åˆ›å»ºçš„ä¹¦ç­¾ä¿¡æ¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
      â”‚                                                    â”‚
      â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 7. åŒæ­¥å®Œæˆï¼Œä¿å­˜æ—¶é—´æˆ³ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚
      â”‚                                                    â”‚

  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• å®æ—¶ç›‘å¬ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

      â”‚  onCreated â”€â”€â–º POST /api/bookmarks                 â”‚
      â”‚  onChanged â”€â”€â–º PUT /api/bookmarks/:id              â”‚
      â”‚  onRemoved â”€â”€â–º DELETE /api/bookmarks/:id           â”‚
      â”‚  onMoved   â”€â”€â–º PUT /api/bookmarks/:id/move         â”‚
```

---

## ğŸ¤– Cursor Agent Skills

æœ¬é¡¹ç›®ä½¿ç”¨ **Cursor Agent Skills** è¾…åŠ©å¼€å‘ï¼ŒSkills æ˜¯å¯å¤ç”¨çš„ AI å¼€å‘æŒ‡å—ï¼Œå¸®åŠ© AI ç†è§£é¡¹ç›®ç‰¹å®šé¢†åŸŸçš„çŸ¥è¯†å’Œæœ€ä½³å®è·µã€‚

### ä½¿ç”¨çš„ Skills

| Skill | è·¯å¾„ | ä½œç”¨ |
|-------|------|------|
| `browser-extension-builder` | `.cursor/skills/browser-extension-builder/` | æµè§ˆå™¨æ‰©å±•å¼€å‘æŒ‡å¯¼ |
| `bookmark-sync-service` | `.cursor/skills/bookmark-sync-service/` | åŒæ­¥æœåŠ¡å¼€å‘æŒ‡å¯¼ |

### 1. browser-extension-builder Skill

**ä½œç”¨**ï¼šæŒ‡å¯¼ AI æ„å»º Chrome Manifest V3 æµè§ˆå™¨æ‰©å±•

**åŒ…å«å†…å®¹**ï¼š
- Service Worker ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ˆ30ç§’è¶…æ—¶ã€5åˆ†é’Ÿæ‰§è¡Œé™åˆ¶ï¼‰
- `chrome.bookmarks` API å®Œæ•´ç”¨æ³•ï¼ˆç›‘å¬ã€è¯»å–ã€ä¿®æ”¹ï¼‰
- `chrome.storage` æœ¬åœ°å­˜å‚¨ä½¿ç”¨
- WebSocket åœ¨ Service Worker ä¸­çš„ä¿æ´»æœºåˆ¶
- Vite æ„å»ºé…ç½®
- è·¨æµè§ˆå™¨å…¼å®¹æ€§ï¼ˆChrome/Firefoxï¼‰

**å‚è€ƒæ–‡æ¡£**ï¼š
- `reference/manifest-v3-guide.md` - Manifest V3 å®Œæ•´æŒ‡å—
- `reference/websocket-keepalive.md` - WebSocket ä¿æ´»æ¨¡å¼

**åœ¨æœ¬é¡¹ç›®ä¸­çš„åº”ç”¨**ï¼š
```typescript
// åŸºäº Skill æŒ‡å¯¼å®ç°çš„ä¹¦ç­¾ç›‘å¬
chrome.bookmarks.onCreated.addListener(onBookmarkCreated);
chrome.bookmarks.onChanged.addListener(onBookmarkChanged);
chrome.bookmarks.onRemoved.addListener(onBookmarkRemoved);
chrome.bookmarks.onMoved.addListener(onBookmarkMoved);

// åŸºäº Skill æŒ‡å¯¼çš„å®šæ—¶ä»»åŠ¡ï¼ˆé¿å… setIntervalï¼‰
chrome.alarms.create('periodic-sync', { periodInMinutes: 5 });
```

### 2. bookmark-sync-service Skill

**ä½œç”¨**ï¼šæŒ‡å¯¼ AI æ„å»ºä¹¦ç­¾åŒæ­¥åç«¯æœåŠ¡

**åŒ…å«å†…å®¹**ï¼š
- æ•°æ®æ¨¡å‹è®¾è®¡ï¼ˆBookmarkã€SyncEventã€Userï¼‰
- åŒæ­¥åè®®è§„èŒƒï¼ˆå…¨é‡åŒæ­¥ã€å¢é‡åŒæ­¥ã€å†²çªè§£å†³ï¼‰
- REST API è®¾è®¡
- SQLite æ•°æ®åº“ Schema
- WebSocket å®æ—¶é€šä¿¡
- ä¹è§‚é”å†²çªå¤„ç†
- éƒ¨ç½²æ–¹æ¡ˆï¼ˆè‡ªæ‰˜ç®¡ã€Vercelã€Cloudflareï¼‰

**å‚è€ƒæ–‡æ¡£**ï¼š
- `reference/sync-protocol.md` - åŒæ­¥åè®®è¯¦ç»†è§„èŒƒ
- `reference/conflict-resolution.md` - å†²çªè§£å†³ç­–ç•¥

**åœ¨æœ¬é¡¹ç›®ä¸­çš„åº”ç”¨**ï¼š
```typescript
// åŸºäº Skill å®šä¹‰çš„æ•°æ®æ¨¡å‹
interface Bookmark {
  id: string;
  userId: string;
  parentId: string | null;
  title: string;
  url: string | null;
  isFolder: boolean;
  sortOrder: number;
  syncVersion: number;
  // ...
}

// åŸºäº Skill è®¾è®¡çš„ API ç«¯ç‚¹
app.use('/api/auth', authRouter);      // è®¤è¯
app.use('/api/bookmarks', bookmarksRouter);  // ä¹¦ç­¾ CRUD
```

### å¦‚ä½•ä½¿ç”¨ Skills

1. **åœ¨ Cursor ä¸­å¼€å‘**ï¼šSkills ä¼šè‡ªåŠ¨è¢« AI è¯†åˆ«å’Œä½¿ç”¨
2. **æ‰‹åŠ¨å‚è€ƒ**ï¼šé˜…è¯» `.cursor/skills/*/SKILL.md` å’Œ `reference/` ç›®å½•

### åˆ›å»ºè‡ªå®šä¹‰ Skill

```
.cursor/skills/your-skill/
â”œâ”€â”€ SKILL.md           # ä¸»æ–‡ä»¶ï¼ŒåŒ…å«æ ¸å¿ƒæŒ‡å¯¼
â””â”€â”€ reference/         # å‚è€ƒæ–‡æ¡£
    â”œâ”€â”€ api-guide.md
    â””â”€â”€ examples.md
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
bookmark-sync/
â”œâ”€â”€ .cursor/skills/           # Cursor Agent Skills
â”‚   â”œâ”€â”€ browser-extension-builder/
â”‚   â”‚   â”œâ”€â”€ SKILL.md
â”‚   â”‚   â””â”€â”€ reference/
â”‚   â””â”€â”€ bookmark-sync-service/
â”‚       â”œâ”€â”€ SKILL.md
â”‚       â””â”€â”€ reference/
â”œâ”€â”€ extension/                # æµè§ˆå™¨æ‰©å±•
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ background/       # Service Worker
â”‚   â”‚   â”œâ”€â”€ popup/            # å¼¹çª—ç•Œé¢
â”‚   â”‚   â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ manifest.json
â”œâ”€â”€ web/                      # å¯¼èˆªç½‘ç«™ (Next.js 14)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/              # App Router
â”‚   â”‚   â”œâ”€â”€ components/       # React ç»„ä»¶
â”‚   â”‚   â””â”€â”€ hooks/            # è‡ªå®šä¹‰ Hooks
â”‚   â””â”€â”€ public/               # é™æ€èµ„æº
â”œâ”€â”€ server/                   # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ routes/           # API è·¯ç”±
â”‚   â”‚   â””â”€â”€ db/               # æ•°æ®åº“æ“ä½œ
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ packages/shared/          # å…±äº«ç±»å‹å®šä¹‰
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ nginx/                    # Nginx é…ç½®
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 18.0.0
- pnpm >= 8.0.0

### æœ¬åœ°å¼€å‘

```bash
# å®‰è£…ä¾èµ–
pnpm install

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
pnpm dev

# æˆ–åˆ†åˆ«å¯åŠ¨
pnpm dev:server    # åç«¯ http://localhost:3000
pnpm dev:web       # å‰ç«¯ http://localhost:3001
pnpm dev:extension # æ‰©å±• (watch mode)
```

### æ„å»º

```bash
pnpm build           # æ„å»ºå…¨éƒ¨
pnpm build:extension # ä»…æ„å»ºæ‰©å±•
```

---

## ğŸ”Œ æµè§ˆå™¨æ‰©å±•

### å®‰è£…æ­¥éª¤

1. `pnpm build:extension`
2. æ‰“å¼€ `chrome://extensions`
3. å¼€å¯"å¼€å‘è€…æ¨¡å¼"
4. ç‚¹å‡»"åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº"
5. é€‰æ‹© `extension/dist` ç›®å½•

### é…ç½®è¯´æ˜

| é…ç½®é¡¹ | è¯´æ˜ |
|--------|------|
| APIæœåŠ¡å™¨åœ°å€ | åç«¯ API åœ°å€ï¼Œå¦‚ `https://api.example.com` |
| å¯¼èˆªç½‘ç«™åœ°å€ | å‰ç«¯ç½‘ç«™åœ°å€ï¼Œå¦‚ `https://nav.example.com` |

---

## ğŸ³ Docker éƒ¨ç½²

```bash
# 1. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env è®¾ç½® JWT_SECRET å’Œ NEXT_PUBLIC_API_URL

# 2. æ„å»ºå¹¶å¯åŠ¨
docker-compose build
docker-compose up -d

# 3. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

---

## ğŸ”§ æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯ |
|------|------|
| æµè§ˆå™¨æ‰©å±• | Chrome Extension Manifest V3, React, TypeScript, Vite |
| å¯¼èˆªç½‘ç«™ | Next.js 14, React 18, Tailwind CSS, Fuse.js |
| åç«¯æœåŠ¡ | Node.js, Express, sql.js (SQLite), JWT |
| æ•°æ®åº“ | SQLite (sql.js çº¯ JS å®ç°) |

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0

- å•å‘åŒæ­¥ï¼šæµè§ˆå™¨ â†’ æœåŠ¡å™¨
- å¯¼èˆªç½‘ç«™é¦–é¡µç›´æ¥å±•ç¤ºä¹¦ç­¾æ å†…å®¹
- ä¹¦ç­¾åœ¨ä¸Šã€æ–‡ä»¶å¤¹åœ¨ä¸‹çš„å±•ç¤ºé¡ºåº
- éšè—"å…¶ä»–ä¹¦ç­¾"æ–‡ä»¶å¤¹
- æ”¯æŒäº®è‰²/æš—è‰²/è‡ªåŠ¨ä¸»é¢˜åˆ‡æ¢
- Docker Compose ä¸€é”®éƒ¨ç½²
- æ‰©å±•æ”¯æŒ API è¿æ¥æµ‹è¯•
- Cursor Agent Skills è¾…åŠ©å¼€å‘

---

## ğŸ“„ License

MIT
